<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Publicar Anuncio</title>
    <link rel="stylesheet" href="styles/agregar_producto.css">
</head>
<body>
    <!-- Modal/Pop-up para mostrar detalles del producto -->
    <div id="productoModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="ModalModule.cerrarModal()">&times;</span>
            <h2 id="modal-titulo"></h2>
            <p id="modal-precio"></p>
            <p id="modal-descripcion"></p>
            <p id="modal-ubicacion"></p>
            <div id="modal-imagenes"></div>
            <hr>
            <div class="modal-actions">
                <button onclick="ModalModule.contactarVendedor()">
                    Contactar al interesado
                </button>
            </div>
        </div>
    </div>

    <!-- Formulario de publicaci贸n de anuncio -->
    <form id="anuncioForm" method="post" action="guardar_producto.php" enctype="multipart/form-data">
        
        <!-- Tipo de anuncio: Oferta o Demanda -->
        <div class="form-group">
            <label>Tipo de anuncio:</label>
            <div class="tipo-anuncio">
                <button type="button" id="btn-oferta" class="active" onclick="FormModule.seleccionarTipo('oferta')">
                     OFERTA
                </button>
                <button type="button" id="btn-demanda" onclick="FormModule.seleccionarTipo('demanda')">
                     DEMANDA
                </button>
            </div>
            <!-- Campo oculto donde guardamos la opci贸n seleccionada (oferta/demanda) -->
            <input type="hidden" id="tipo_anuncio" name="tipo_anuncio" value="oferta">
        </div>
        
        <!-- Categor铆a y subcategor铆a -->
        <div class="form-row">
            <div class="form-group">
                <label for="categoria">Categor铆a:</label>
                <select id="categoria" name="categoria" required onchange="CategoriasModule.actualizarSubcategorias()">
                    <option value="">Seleccione una categor铆a</option>
                    <option value="alimentos" data-emoji=""> Alimentos</option>
                    <option value="ropa" data-emoji=""> Ropa</option>
                    <option value="calzado" data-emoji=""> Calzado</option>
                    <option value="juguetes" data-emoji="Ц">Ц Juguetes</option>
                    <option value="libros" data-emoji=""> Libros</option>
                    <option value="electronica" data-emoji=""> Electr贸nica</option>
                    <option value="hogar" data-emoji=""> Hogar y Decoraci贸n</option>
                    <option value="servicios" data-emoji=""> Servicios</option>
                    <option value="vehiculos" data-emoji=""> Veh铆culos</option>
                    <option value="inmuebles" data-emoji=""> Inmuebles</option>
                    <option value="trabajo" data-emoji=""> Trabajo</option>
                    <option value="otros" data-emoji=""> Otros</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="subcategoria">Subcategor铆a:</label>
                <select id="subcategoria" name="subcategoria" required>
                    <option value="">Primero seleccione una categor铆a</option>
                </select>
            </div>
        </div>

        <!-- T铆tulo y precio -->
        <div class="form-row">
            <div class="form-group">
                <label for="titulo">T铆tulo: 
                    <span id="emoji-preview" class="emoji-preview"></span>
                </label>
                <input type="text" id="titulo" name="titulo" required 
                       placeholder="T铆tulo breve y descriptivo">
                <!-- Campo oculto donde guardamos el emoji de la categor铆a -->
                <input type="hidden" id="emoji" name="emoji" value="">
            </div>
            
            <div class="form-group">
                <label for="precio">Precio ($):</label>
                <input type="number" id="precio" name="precio" required 
                       min="0" step="0.01" placeholder="0.00">
            </div>
        </div>
        
        <!-- Descripci贸n breve -->
        <div class="form-group">
            <label for="descripcion_breve">Descripci贸n breve:</label>
            <textarea id="descripcion_breve" name="descripcion_breve" required 
                      placeholder="Describa brevemente su anuncio (m谩x. 200 caracteres)" 
                      maxlength="200"></textarea>
        </div>
        
        <!-- Descripci贸n detallada (para la tabla expandible) -->
        <div class="form-group">
            <label for="descripcion_detallada">Descripci贸n detallada:</label>
            <textarea id="descripcion_detallada" name="descripcion_detallada" 
                      placeholder="Incluya todos los detalles importantes de su anuncio">
            </textarea>
        </div>
        
        <!-- Ubicaci贸n -->
        <div class="form-group">
            <label for="ubicacion">Direcci贸n/Zona:</label>
            <input type="text" id="ubicacion" name="ubicacion" 
                   placeholder="Barrio, calle, referencia, etc.">
        </div>
        
        <!-- Im谩genes -->
        <div class="form-group">
            <label for="imagenes">Im谩genes (opcional):</label>
            <input type="file" id="imagenes" name="imagenes[]" 
                   multiple accept="image/*">
            <small>Puede seleccionar varias im谩genes. Formatos aceptados: JPG, PNG, GIF</small>
        </div>
        
        <!-- Informaci贸n de contacto -->
        <div class="form-group">
            <label>Informaci贸n de contacto:</label>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="telefono">Tel茅fono fijo (opcional):</label>
                    <input type="tel" id="telefono" name="telefono" 
                           placeholder="Ej. (01) 1234-5678">
                </div>
                
                <div class="form-group">
                    <label for="celular">Tel茅fono celular (opcional):</label>
                    <input type="tel" id="celular" name="celular" 
                           placeholder="Ej. (011) 15-1234-5678">
                </div>
            </div>
            
            <div class="form-group">
                <label for="email">Correo electr贸nico (opcional):</label>
                <input type="email" id="email" name="email" 
                       placeholder="ejemplo@correo.com">
            </div>
        </div>
        
        <!-- Campos ocultos para la geolocalizaci贸n -->
        <input type="hidden" id="latitud" name="latitud">
        <input type="hidden" id="longitud" name="longitud">
        
        <div id="ubicacionStatus">Detectando su ubicaci贸n actual...</div>
        
        <!-- Bot贸n enviar desactivado hasta que obtenga la geolocalizaci贸n o se ingrese manual -->
        <button type="submit" id="submitBtn" disabled>Publicar Anuncio</button>
    </form>

    <!-- M贸dulos JavaScript -->
    <script src="js/modules/agregar_producto_utils.js"></script>
    <script src="js/modules/agregar_producto_geo.js"></script>
    <script src="js/modules/agregar_producto_categorias.js"></script>
    <script src="js/modules/agregar_producto_forms.js"></script>
    <script src="js/modules/agregar_producto_modal.js"></script>
    <script src="js/agregar_producto.js"></script>
</body>
</html>